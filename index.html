<!DOCTYPE html>
<html>
<head>
  <title>Ivan's Spectacular Website</title>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; margin: 50px; }
    h1 { font-size: 28px; margin-bottom: 10px; }
    h2 { font-size: 18px; font-weight: normal; color: #555; margin-bottom: 30px; }
    input { padding: 5px 10px; border-radius: 6px; border: 1px solid #ccc; font-size: 16px; margin:5px 0; }
    button { padding: 8px 15px; border-radius: 6px; border: none; background: #5865f2; color: white; cursor: pointer; margin:5px 0; }
    button:hover { background: #4752c4; }
    #chatBox { width: 400px; height: 300px; border: 1px solid #ccc; border-radius: 6px; margin: 20px auto; text-align: left; overflow-y: auto; padding: 10px; background: #2f3136; color: white; }
    .message { margin: 5px 0; padding: 5px 10px; background: #40444b; border-radius: 6px; }
    #urlInput { width: 300px; height: 35px; }
    #openBtn { height: 45px; }
  </style>

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
</head>
<body>
  <h1>Ivan's Spectacular Website</h1>
  <h2>About blank website embedder</h2>

  <!-- About Blank Input -->
  <input type="text" id="urlInput" placeholder="Enter a website (e.g. example.com)">
  <button id="openBtn" onclick="openSite()">Open in about:blank</button>

  <!-- Chat Section -->
  <h2>Online Chat</h2>
  <input type="text" id="nickname" placeholder="Enter your name">
  <div id="chatBox"></div>
  <input type="text" id="messageInput" placeholder="Type a message">
  <button id="sendBtn" onclick="sendMessage()">Send</button>

  <script>
    // ===== Firebase Setup =====
    const firebaseConfig = {
      apiKey: "AIzaSyAGrQ7nKx2lJ6RaLn-6vm2vxuJXxa9e25U",
      authDomain: "school-chat-3528a.firebaseapp.com",
      databaseURL: "https://school-chat-3528a-default-rtdb.firebaseio.com",
      projectId: "school-chat-3528a",
      storageBucket: "school-chat-3528a.firebasestorage.app",
      messagingSenderId: "818009457564",
      appId: "1:818009457564:web:6bb7ae1159d3d58fb5be59",
      measurementId: "G-EH439XDW16"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // ===== Automatically open About:blank in new tab on page load =====
    window.onload = function() {
      let newWin = window.open("about:blank");
      let doc = newWin.document;
      doc.write("<h1>Welcome to Ivan's Spectacular Website!</h1>");
      doc.write("<p>This is your about:blank page.</p>");
    };

    // ===== About Blank Loader =====
    function openSite() {
      let url = document.getElementById("urlInput").value;
      if (!/^https?:\/\//i.test(url)) {
        url = "https://" + url;
      }
      let newWin = window.open("about:blank");
      let doc = newWin.document;
      doc.write(`<iframe src="${url}" style="width:100%;height:100%;border:none;"></iframe>`);
      doc.title = url;
    }

    // ===== Global Chat =====
    const chatBox = document.getElementById("chatBox");
    const nicknameInput = document.getElementById("nickname");

    db.ref("messages").on("child_added", snapshot => {
      const msg = snapshot.val();
      const div = document.createElement("div");
      div.className = "message";
      div.textContent = `${msg.name}: ${msg.text}`;
      chatBox.appendChild(div);
      chatBox.scrollTop = chatBox.scrollHeight;
    });

    function sendMessage() {
      const name = nicknameInput.value.trim() || "Anonymous";
      const text = document.getElementById("messageInput").value.trim();
      if (text !== "") {
        db.ref("messages").push({ name, text });
        document.getElementById("messageInput").value = "";
      }
    }
  </script>
</body>
</html>
